version: 2.1
orbs:
  sfdx: circleci/salesforce-sfdx@2.2.0

jobs:
  validate:
    executor: sfdx/default
    steps:
      - checkout
      - sfdx/install
      - sfdx/auth:
          defaultusername: $SALESFORCE_USERNAME
          instanceUrl: https://test.salesforce.com
      
      - run:
          name: Validate 
          command: sfdx force:source:deploy  --checkonly --sourcepath veygo-app --targetusername $SALESFORCE_USERNAME --testlevel RunLocalTests 

workflows:
  main:
    jobs:
      - validate:
          context:
            - SALESFORCE_DEV
          filters:
            branches:
              ignore:
                - master
